# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура приложения
Код приложения разделен на слои согласно парадигме MVP:
* слой представления, отвечает за отображение данных на странице,
* слой данных, отвечает за хранение и изменение данных
* презентер, отвечает за связь представления и данных.

### Базовый код
#### Класс Api

Содержит в себе базовую логику отправки запросов. В конструктор передается базовый
адрес сервера и опциональный объект с заголовками запросов.
Методы:

* `get` - выполняет GET запрос на переданный в параметрах ендпоинт и возвращает
  промис с объектом, которым ответил сервер
* `post` - принимает объект с данными, которые будут переданы в JSON в теле
  запроса, и отправляет эти данные на ендпоинт переданный как параметр при вызове
  метода. По умолчанию выполняется `POST` запрос, но метод запроса может быть
  переопределен заданием третьего параметра при вызове.

#### Класс EventEmitter
Брокер событий позволяет отправлять события и подписываться на события, происходящие в
системе. Класс используется в презентере для обработки событий и в слоях приложения для
генерации событий.
Основные методы, реализуемые классом описаны интерфейсом `IEvents`:
* `оn` - подписка на событие
* `emit` - инициализация события
* `trigger` - возвращает функцию, при вызове которой инициализируется требуемое в
  параметрах событие

#### Класс Model
Базовый класс для работы с моделями данных. Содержит в себе проверку,
является ли переданный объект экземпляром класса `Model`.
Так же содержит метод `emitChanges`. Этот метод сообщает всем подписчикам об изменении модели,
отправляя указанное событие `event` и необязательные данные `payload`.

#### Класс Component
Абстрактный класс Component, который служит базовым компонентом для работы с пользовательским интерфейсом.
Методы:
* `toggleClass` - переключает класс у указанного HTML-элемента
* `setDisabled` - устанавливает состояние блокировки у указанного HTML-элемента
* `setHidden` - скрывает указанный HTML-элемент
* `setVisible` - показывает указанный HTML-элемент
* `setImage` - устанавливает источник изображения и альтернативный текст
*  `render` - возвращает корневой HTML-элемент компонента

## Слой данных (хранение и изменение данных)
### Данные и типы данных, используемые в приложении
Интерфейс продукта (IProduct) - структура данных для отдельного товара.
```
export interface IProduct {
	_id: string;
	description: string;
	image: string;
	title: string;
	category: string;
	price: number|null;
}
```
Интерфейс списка товаров (IProductList) - структура данных для списка доступных товаров.
Включает в себя методы:
* `setItems` - для установки, после загрузки из API
* `getProduct` - чтобы получения при рендере списков
```
export interface IProductList {
	items: IProduct [];
	setItems (items: IProduct[]): void;
	getProduct(id: string): IProduct;
}
```
Интерфейс заказа (IOrder) - структура данных для формирования заказа.
Включает в себя методы:
* `addItem` - для добавления товара в заказ
* `removeItem` - для удаления товара из заказа
* `clearItems` - для очистки списка товаров в заказе
* `calculateTotal` - для вычисления суммы заказа
```
export interface IOrder {
	items: IProduct[];
	total: number;
	email: string;
	phone: string;
	payment: string;
	address: string;
	addItem(item: IProduct): void;
	removeItem(id: string): void;
	clearItems(): void;
	calculateTotal(): number;
}
```
Тип для карточки товара в списке (ProductCart),
использует всю структуру из `IProduct`, кроме описания
```
export type ProductCart = Pick<IProduct, Exclude<keyof IProduct, 'description'>>;
```
Тип для модальног окна товара (ProductInfo),
использует всю структу из `IProduct`
```
export type ProductInfo = IProduct;
```
Тип для модального окна корзины (CartInfo),
использует список товаров в заказе и итоговую сумму из `IOrder`
```
export type CartInfo = Pick<IOrder, 'items' | 'total'>
```
Тип для модального окна выбора способа оплаты и ввода адреса доставки (PaymentAndAddressForm),
использует тип оплаты и адрес доставки из `IOrder`
```
export type PaymentAndAddressForm = Pick<IOrder, 'payment' | 'address'>
```
Тип для модального окна ввода контактных данных (ContactForm),
использует почту и телефон из `IOrder`
```
export type ContactForm = Pick<IOrder, 'email' | 'phone'>
```
Тип для модального окна успешного оформления заказа (SuccessInfo),
использует итоговую сумму заказа из `IOrder`
```
export type SuccessInfo = Pick<IOrder, 'total'>
```